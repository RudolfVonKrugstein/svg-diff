<!DOCTYPE html>
<head>
    <title>Demo page</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/d3/7.6.1/d3.min.js" integrity="sha512-MefNfAGJ/pEy89xLOFs3V6pYPs6AmUhXJrRlydI/9wZuGrqxmrdQ80zKHUcyadAcpH67teDZcBeS6oMJLPtTqw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <script src="./../js_assets/animator.js"></script>
</head>
<body>
<h1>SVG Animation Demo</h1>
<div style="float: left">
    <label for="diagram">Input Diagram</label>
    <br/>
    <textarea id="diagram" cols="50" rows="16"></textarea>
    <br/>
    <button onclick="next_diagram()">Send</button>
</div>
<div style="float: right;">
    <div id="content-container" style="height:auto; width: 500px; background-color: gray; overflow: hidden; resize: horizontal">
    </div>
</div>
<script>
    load_base_svg("content-container");

    async function next_diagram() {
        let response = await fetch('./new_diagram', {
            method: 'POST',
            body: document.getElementById("diagram").value
        });
        if (!response.ok) {
            console.log("error:", await response.text());
            return;
        }
        let result = await response.json();
        if (result.svg !== undefined) {
            await load_base_svg("content-container", result.svg);
        }
        if (result.diffs !== undefined) {
            apply_animation(result.diffs);
        }
    }


</script>
</body>
